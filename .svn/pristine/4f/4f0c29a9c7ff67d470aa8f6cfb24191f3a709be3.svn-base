package enklikanketa.com.a1kapanel.Libraries;

import android.app.Notification;
import android.app.NotificationManager;
import android.app.PendingIntent;
import android.content.Context;
import android.content.Intent;
import android.support.v4.app.NotificationCompat;

import java.util.Map;

import enklikanketa.com.a1kapanel.R;
import enklikanketa.com.a1kapanel.WebResevanje;

import static android.content.Context.NOTIFICATION_SERVICE;

/**
 * Created by podkrizniku on 06/12/2017.
 */

public class NotificationLib {

    public static void showNotificationSurvey(Context ctx, Map<String, String> data) {
        if(data != null) {
            //you can get your text message here.
            String message = data.get("message");
            String title = data.get("title");
            String link = data.get("link");
            String sound = data.get("sound");
            String sender_id = data.get("sender_id");

            Intent intent = new Intent(ctx, WebResevanje.class);
            intent.putExtra("link", link);

            int id;
            if (sender_id != null)
                id = Integer.parseInt(sender_id);
            else
                id = GeneralLib.getRandomInt();

            PendingIntent pi = PendingIntent.getActivity(ctx, id, intent, PendingIntent.FLAG_UPDATE_CURRENT);

            NotificationCompat.Builder notificationBuilder = new NotificationCompat.Builder(ctx)
                    .setTicker(ctx.getString(R.string.app_name))
                    .setSmallIcon(android.R.drawable.ic_menu_myplaces)
                    .setContentTitle(title)
                    .setContentText(message)
                    .setContentIntent(pi)
                    //.addAction(action)
                    //.setOngoing(true);//non removable
                    .setAutoCancel(true);//removable on touch action

            if (sound != null && sound.equals("1"))
                notificationBuilder.setDefaults(Notification.DEFAULT_ALL);

            Notification notification = notificationBuilder.build();

            NotificationManager notificationManager = (NotificationManager) ctx.getSystemService(NOTIFICATION_SERVICE);
            if (notificationManager != null)
                notificationManager.notify(id, notification);
        }
    }
}
