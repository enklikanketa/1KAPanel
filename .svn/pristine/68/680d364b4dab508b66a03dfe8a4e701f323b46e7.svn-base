package enklikanketa.com.a1kapanel.Receivers;

import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;

import net.nextpin.geolib.NextPin;

import enklikanketa.com.a1kapanel.Libraries.ActivityLib;
import enklikanketa.com.a1kapanel.Libraries.AlarmLib;
import enklikanketa.com.a1kapanel.Libraries.TrackingLib;

public class MyStartServiceReceiver extends BroadcastReceiver {

    @Override
    public void onReceive(Context context, Intent intent) {
        AlarmLib alib = new AlarmLib(context);
        alib.checkAndRunAlarms();

        //just in case, to reset variable of isStarted from SharedPreferences on false
        NextPin.getNextPinInstance(context).stop();

        //run nextpin if there are subscribed surveys using it
        ActivityLib aclib = new ActivityLib(context);
        if(aclib.areActivityPermissionGrantedAndRunning()) {
            aclib.startNextpin("boot");
        }

        //run tracking if there are subscribed surveys using it
        TrackingLib tlib = new TrackingLib(context);
        if(tlib.areTrackingPermissionGrantedAndRunning()) {
            tlib.startTracking("boot");
        }
    }
}